<!-- menu.html — Einzeilige Top-Leiste (minimal, dezent)
     IDs/Elemente werden vom menu.js erwartet:
     home-btn, toc-toggle, toc-list, menu-guide-btn, settings-btn,
     account-toggle, account-popover, admin-view-btn, admin-popover,
     current-page-title
-->
<nav id="site-topbar" class="cm-topbar" role="navigation" aria-label="Hauptmenü">
  <div class="cm-topbar-inner">

    <!-- links: Home -->
    <div class="cm-left">
      <a id="home-btn" class="cm-home" href="#" title="Startseite">Start</a>
    </div>

    <!-- zentriert: Seiten-Titel / Indikator -->
    <div class="cm-center">
      <span id="current-page-title" class="cm-page-title" aria-hidden="true"></span>
    </div>

    <!-- rechts: Controls -->
    <div class="cm-right">

      <!-- Inhalts-Navigation (TOC) Dropdown -->
      <div class="cm-control">
        <button id="toc-toggle" class="cm-btn" aria-expanded="false" aria-controls="toc-list" title="Abschnitte anzeigen">
          Inhaltsverzeichnis ▾
        </button>
        <div id="toc-list" class="cm-toc-dropdown" role="menu" aria-hidden="true" data-minwidth="220px">
          <button class="cm-popover-close" aria-label="Schließen">×</button>
          <!-- menu.js füllt diesen Bereich bei Seitenaufbau -->
          <div class="cm-toc-inner">Keine Abschnitte gefunden.</div>
        </div>
      </div>

      <!-- Menü-Guide -->
      <button id="menu-guide-btn" class="cm-btn" title="Kurzanleitung / Guide">Guide</button>

      <!-- Einstellungen -->
      <button id="settings-btn" class="cm-btn" title="Einstellungen">Einstellungen</button>

      <!-- Account -->
      <div class="cm-control account-control">
        <button id="account-toggle" class="cm-btn" aria-expanded="false" aria-controls="account-popover" title="Account-Optionen">
          <span id="account-username">Gast</span> ▾
        </button>

        <div id="account-popover" class="cm-popover" role="menu" aria-hidden="true" data-minwidth="240px">
          <button class="cm-popover-close" aria-label="Schließen">×</button>
          <div class="account-block">
            <strong id="popover-username">Gast</strong>
            <div id="popover-role" class="muted">Gast</div>
          </div>
          <hr/>
          <ul class="account-actions" style="padding:0; margin:0; list-style:none;">
            <li style="margin:6px 0;"><button data-action="account-info" class="cm-popbtn">Account-Informationen</button></li>
            <li style="margin:6px 0;"><button data-action="settings" class="cm-popbtn">Einstellungen</button></li>
            <li style="margin:6px 0;"><button data-action="logout" class="cm-popbtn">Abmelden</button></li>
          </ul>
        </div>
      </div>

      <!-- Admin-View (nur sichtbar für Admins; menu.js zeigt es) -->
      <div class="cm-control admin-control" style="display:none;">
        <button id="admin-view-btn" class="cm-btn" aria-expanded="false" aria-controls="admin-popover" title="Admin: Ansicht wechseln">Admin ▾</button>

        <div id="admin-popover" class="cm-popover" role="menu" aria-hidden="true" data-minwidth="240px">
          <button class="cm-popover-close" aria-label="Schließen">×</button>
          <div style="padding:6px 0 10px 0; font-weight:600;">Admin-Optionen</div>
          <ul style="list-style:none; padding:0; margin:0;">
            <li style="margin:6px 0;"><button data-action="view-as-admin" class="cm-popbtn">Ansicht: Admin</button></li>
            <li style="margin:6px 0;"><button data-action="view-as-dm" class="cm-popbtn">Ansicht: DM</button></li>
            <li style="margin:6px 0;"><button data-action="view-as-player" class="cm-popbtn">Ansicht: Spieler</button></li>
            <li style="margin:6px 0;"><button data-action="view-as-guest" class="cm-popbtn">Ansicht: Gast</button></li>
            <li style="margin:6px 0;"><a href="home_admin.html" class="cm-popbtn" style="display:inline-block; text-decoration:none;">Admin-Startseite</a></li>
          </ul>
        </div>
      </div>

    </div><!-- .cm-right -->

  </div><!-- .cm-topbar-inner -->
</nav>

<!-- Platz für Modals, die menu.js generiert (optional placeholder) -->
<div id="cm-modals-root"></div>
